/*
오징어 게임 OST "Way Back Then"
피에조 부저 연주

배열의 용량이 커 PROGMEM 메크로로 스케치 저장공간에 저장하고, 읽어오는 방식 사용
https://www.youtube.com/watch?v=_Vi8LphUFGo 악보 출처
*/

#define Buzzer 6
int term = 2000;

//3옥타브
const float c3 = 130.8128, d3 = 146.8324, e3 = 164.8138, f3 = 174.6141, g3 = 195.9977, a3 = 220.0, b3 = 246.9417;
//4옥타브
const float c4 = 261.6256, d4 = 293.6648, e4 = 329.6276, f4 = 349.2282, g4 = 391.9954, a4 = 440.0, b4 = 493.8833;

//5옥타브
const float c5 = 523.2511, d5 = 587.3295, e5 = 659.2551, f5 = 698.4565, g5 = 783.9909, a5 = 880.0, b5 = 987.7666;
const float cS5 = 553.3653;

const PROGMEM float NoteSong[][2] = {
{a4,8},{a4,8},{a4,4},{a4,8},{a4,8},{a4,4},
{cS5, 8},{a4,8},{a4,8},{g4,8},{f4,8},{g4,8},{a4,4},
{a4,8},{a4,8},{a4,4},{a4,8},{a4,8},{a4,4}, //1-1
{a4, 8},{g4,8},{f4,8},{g4,8},{f4,8},{d4,8},{d4,4},
{a4,8},{a4,8},{a4,4},{a4,8},{a4,8},{a4,4},
{cS5, 8},{a4,8},{a4,8},{g4,8},{f4,8},{g4,8},{a4,4},
{a4,8},{a4,8},{a4,4},{a4,8},{a4,8},{a4,4},
{a4, 8},{g4,8},{f4,8},{g4,8},{f4,8},{d4,8},{d4,4}, //1-2

{g3,4},{g3,4},{g3,4},{g3,4},//대기중
{g3,4},{g3,4},{g3,4},{g3,4},
{g3,4},{g3,4},{g3,4},{g3,4},
{g3,4},{g3,4},{g3,4},{0,4},

{a4,8},{a4,8},{a4,4},{a4,8},{a4,8},{a4,4}, //1-3
{cS5, 8},{a4,8},{a4,8},{g4,8},{f4,8},{g4,8},{a4,4}, 
{a4,8},{a4,8},{a4,4},{a4,8},{a4,8},{a4,4},//1-4
{a4, 8},{g4,8},{f4,8},{g4,8},{f4,8},{d4,8},{d4,4},
{a4,8},{a4,8},{a4,4},{a4,8},{a4,8},{a4,4},

{cS5, 8},{a4,8},{a4,8},{g4,8},{f4,8},{g4,8},{a4,4}, //2-1
{a4,8},{a4,8},{a4,4},{a4,8},{a4,8},{a4,4},
{a4, 8},{g4,8},{f4,8},{g4,8},{f4,8},{d4,8},{d4,4},
{d4,8},{e4,8},{d4,8},{e4,8},{d4,8},{e4,8},{d4,8},{e4,8}, //2-2
{d4,8},{e4,8},{d4,8},{e4,8},{d4,8},{e4,8},{d4,8},{e4,8},
{d4,8},{e4,8},{d4,8},{e4,8},{d4,8},{e4,8},{d4,8},{e4,8}, //2-3
{d4,8},{e4,8},{d4,8},{e4,8},{d4,8},{e4,8},{d4,8},{e4,8},
{d4,1},
{0,1}, //2-4

{d4,1},
{0,4},
{d4,8},{c4,8},{a4,8},{g4,8},{f4,8},{e4,8},
{d4,4},{d4,8},{e4,8},{f4,4},{e4,8},{f4,8}, //3-1
{g4,8},{f4,24},{g4, 24},{f4, 24},{e4, 8},{d4, 8},{c4, 2}, //셋잇단 음표, 16분 음표 세개를 음표 한개 뺀 박자인 8분 음표 박자에 나눠처라
{g4, 8/3},{f4,8},{e4,4},{d4,8},{e4,8},
{f4,4},{e4,4},{f4,4},{g4,4},{a4,2}, //3-2
{d4,8/3},{e4,8},{f4,4},{e4,8},{e4,8},
{g4,8},{f4,24},{g4, 24},{f4, 24},{e4, 8},{d4, 8},{c4, 2}, ////셋잇단 음표, 16분 음표 세개를 음표 한개 뺀 박자인 8분 음표 박자에 나눠처라
{g4, 8/3},{f4,8},{e4,4},{d4,8},{e4,8},
{f4,8},{e4,8},{f4,8},{g4,8},{a4,2},

{g3,4},{g3,4},{g3,4},{g3,4}, //대기중
{g3,4},{g3,4},{g3,4},{0,4},

{a4,8},{a4,8},{a4,4},{a4,8},{a4,8},{a4,4},
{cS5, 8},{a4,8},{a4,8},{g4,8},{f4,8},{g4,8},{a4,4}, //3-4

{a4,8},{a4,8},{a4,4},{a4,8},{a4,8},{a4,4},
{a4, 8},{g4,8},{f4,8},{g4,8},{f4,8},{d4,8},{d4,4},
{a4,8},{a4,8},{a4,4},{a4,8},{a4,8},{a4,4}, //4-1
{cS5, 8},{a4,8},{a4,8},{g4,8},{f4,8},{g4,8},{a4,4},
{a4,8},{a4,8},{a4,4},{a4,8},{a4,8},{a4,4}, //4-2
{a4, 8},{g4,8},{f4,8},{g4,8},{f4,8},{d4,8},{d4,4}, //4-3
};

void setup()
{
  pinMode(Buzzer, OUTPUT);
  for (int i = 0; i < ( sizeof(NoteSong) / sizeof(NoteSong[0]) ); i++) //배열의 한 열(가로)길이를 구한후 전체 길이로 나눠주어서 열의 수를 구한다. 바이트 수를 알고 있는 숫자 값으로 쓰는 건 예기치 못한 오류를 부를 수 있다.
  {
    float Melody = pgm_read_float(&NoteSong[i][0]);
    float Tempo = pgm_read_float(&NoteSong[i][1]);
    tone(Buzzer, Melody, term / Tempo);
    delay((term / Tempo)*1.1);
  }
}

void loop()
{
}
